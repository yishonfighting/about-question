### 服务容量预估

服务的容量预估适用于很多场景，比如：服务/架构新上线之前、服务访问有量变性增长，甚至可以是长期性质的运营活动支撑（用户增长）。

无论是对于哪些场景，你对于现有的服务都要有掌控力，不管是逻辑还是性能。抛开逻辑不谈，了解当前服务性能的最好方式就是做服务压测。暂时先不引入压测的讲解，在压测之前，你还需要对现有的业务访问量有相关的认知，比如多大的用户访问来了之后，机器是否能扛得住，当机器扛不住的时候，我们需要扩容多少台机器？压测可以是做性能摸底，但是压测之前的基础指标你要先明确，之后才能针对压测的数据进行针对性的优化和调整。
衡量服务容量的指标：单机QPS、峰值、平均值、用户数、并发、稳定性，当然，还可以继续引申出会数据维度、服务业务有哪些，数据增长预想等。
我们可以稍微简化一下流程：
评估总访问量。最直接的方式就是让业务方/找数据同学，确认流动的用户量，用户增长模型等。
计算吞吐量QPS。比如，游戏开服一分钟之内会有25w用户进行登录，那么平均QPS就是 ：25w / (1 * 60 ) = 4166 。
评估峰值吞吐量QPS 。  如果有明确的服务访问的趋势图（已有服务），那么以此来计算峰值QPS是相对准确的，当然我们也可以采用二八准则，即80%的请求只会集中在20%的时间上（秒杀场景就不适用了）。拿上面的例子，这么一算，峰值的QPS就会是1.6W,所以很多业务上线之前都会做5倍容量冗余。
之后就可以做单机的QPS压测了。计算出一台机器的QPS，但是，磁盘，内存，io，带宽都不应该是零碎的瓶颈。
